#网络操作
###HTTP
``HTTP``协议构建在请求和响应的概念上，对应在``Nodejs``中就是由``http.ServerRequest``和``http.ServerResponse``这两个构造器构造出来的对象。
```
var http = require('http');

http.createServer(function (req, res) {
	res.writeHead(200, {'Content-Type': 'text/html'});
	res.end('Hello <b>OriginalSoul</b>');
}).listen(3000);
```
``http.Server``事件：
是一个基于事件的``HTTP``服务器，所有的请求都被封装为独立的事件。
``http.ServerRequest``：
提供三个事件用于控制请求体传输：``data``、``end``、``close``。
``http.ServerResponse``:
有三个重要的成员函数：``writeHead``、``write``、``end``。
```
http.createServer(function (request, response) {
    var body = [];

    console.log(request.method);
    console.log(request.headers);

    request.on('data', function (chunk) {
        body.push(chunk);
    });

    request.on('end', function () {
        body = Buffer.concat(body);
        console.log(body.toString());
    });
}).listen(80);
```

---

一个例子：服务端原样将客户端请求的请求体数据返回给客户端。
```javascript
// 服务端
http.createServer(function (req, res) {
	res.writeHead(200, {'Content-Type': 'text/plain'});

	req.on('data', function (chunk) {
		res.write(chunk);
	});

	req.on('end', function () {
		res.end();
	});
}).listen(3000);
```
```javascript
// 客户端
var options = {
	host: '127.0.0.1',
	port: 3000,
	url: '/upload',
	method: 'POST',
	headers: {
		'Content-Type': 'application/x-www-form-urlencoded'
	}
};
//  http.request返回一个http.ClientRequest实例
//  res是http.ClientResponse的实例
var req = http.request(options, function (res) {
	var body = '';
	res.setEncoding('utf8');
	res.on('data', function (chunk) {
		body += chunk;
	});
	res.on('end', function () {
		console.log('We got: '+ body);
	});
});

req.write('Hello World');
req.end();
```
``http``模块也提供了便捷``API``：
```javascript
http.get('http://www.baidu.com', function (res) {
	var body = [];

	console.log(res.statusCode);
	console.log(res.headers);

	res.on('data', function (chunk) {
		body.push(chunk);
	});

	res.on('end', function () {
		body = Buffer.concat(body);
		console.log(body.toString());
	});
});
```
####querystring 模块：
```javascript
var qs = require('querystring');

console.log(qs.parse('name=OriginalSoul&age=24'));

console.log(qs.stringify({name: 'evilcige', age: '24'}));
```
小例子：
```javascript
http.createServer(function (req, res) {
	if ('/' == req.url) {
		res.writeHead(200, {'Content-Type': 'text/html'});
		res.end([
			'<form method="POST" action="/url">'
			,'<h1>My form</h1>'
			,'<fileldset>'
			,'<label>Personal information</label>'
			,'<p>What is your name?</p>'
			,'<input type="text" name="name">'
			,'<p><button>Submit</button></p>'
			,'</form>'
		].join(' '));
	} else if ('/url' == req.url && 'POST' == req.method) {
		var body = '';
		req.on('data', function (chunk) {
			body += chunk;
		});
		req.on('end', function () {
			console.log(body); //name=OriginalSoul

			res.writeHead(200, {'Content-Type': 'text/html'});
			res.end('<p>Your name is <b>'+ qs.parse(body).name +'</b></p>');
		});
	} else {
		res.writeHead(404);
		res.end('Not Found');
	}
}).listen(3000);
```
